<%= content_for :head do %>
  <link rel="alternate"
        type="application/vnd.geo+json"
        href="<%= unsustainable_stats_path(format: :geojson) %>">
<% end %>

<div class="page-header"><h1>Statistics</h1></div>

<%= render partial: 'tabs', locals: { active: 'Unsustainable' } %>

<h2>Unsustainable sites</h2>

<div id="map"></div>

<% if showing_scores? %>
  <ul class="marker-key">
    <li class="very-negative">Very negative</li>
    <li class="negative">Negative</li>
    <li class="neutral">Neutral</li>
    <li class="positive">Positive</li>
    <li class="very-positive">Very positive</li>
  </ul>
<% end %>

<table class="sites table table-striped">
  <thead>
  <tr>
    <th class="shlaa-ref"><span class="hidden-xs">SHLAA ref</span></th>
    <th>Address</th>
    <th class="<%= "hidden-xs" if showing_scores? %>">
      <%= site_sort_link 'Area (ha)', :sort_by_area %>
    </th>
    <th><%= site_sort_link 'Capacity', :sort_by_capacity %></th>
    <th class="hidden-xs hidden-sm">IO / RAG</th>
    <th class="hidden-xs hidden-sm">Settlement hierarchy</th>
    <th class="hidden-xs hidden-sm">Reason</th>
    <% if showing_scores? %>
      <th class="site-total-score col-lg-1 col-md-1 col-sm-1">
        <%= site_sort_link 'Score', :sort_by_score %>
      </th>
    <% end %>
  </tr>
  </thead>

  <tbody>
  <% @sites.each do |site| %>
    <tr class="site">
      <td class="shlaa-ref">
        <span class="shlaa-ref-content">
          <%= green_brown_glyphs(site) %>
          <%= link_to site.shlaa_ref, site %>
         </span>
      </td>
      <td><%= link_to site.address, site %></td>
      <td class="<%= "hidden-xs" if showing_scores? %>"><%= site.area_ha %></td>
      <td><%= site.capacity %></td>
      <td class="hidden-xs hidden-sm"><%= site.io_rag %></td>
      <td class="hidden-xs hidden-sm"><%= site.settlement_hierarchy %></td>
      <td class="hidden-xs hidden-sm"><%= site.reason %></td>
      <% if showing_scores? %>
        <td class="site-total-score col-lg-1 col-md-1 col-sm-1 <%= total_css_class(site.total_score) %>">
          <%= site.total_score || 'â€“' %>
        </td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>
